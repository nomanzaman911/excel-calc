
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Excel Calc Integration</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h2, h3 { margin-top: 20px; }
        .output-box { padding: 10px; background-color: #f0f0f0; margin: 10px 0; }
    </style>
</head>
<body>
    <h2>Excel Output Values</h2>

    <div class="output-box">
        <h3>On-Purlin Solution:</h3>
        <div id="output-O2">Loading...</div>
    </div>

    <div class="output-box">
        <h3>Off-Purlin Solution:</h3>
        <div id="output-O13">Loading...</div>
    </div>

    <div class="output-box">
        <h3>20000 Formula Result:</h3>
        <div id="output-R24">Loading...</div>
    </div>

    <script>
        Office.onReady(function () {
            if (Office.context.requirements.isSetSupported("ExcelApi", "1.1")) {
                updateCellValue('Sheet1', 'O2', 'output-O2');
                updateCellValue('Sheet1', 'O13', 'output-O13');
                updateCellValue('Sheet1', 'R24', 'output-R24');
            }
        });

        function updateCellValue(sheetName, cellAddress, elementId) {
            Excel.run(function (context) {
                var sheet = context.workbook.worksheets.getItem(sheetName);
                var range = sheet.getRange(cellAddress);
                range.load("values");
                return context.sync().then(function () {
                    document.getElementById(elementId).textContent = range.values[0][0];
                });
            }).catch(function (error) {
                console.log("Error: " + error);
                document.getElementById(elementId).textContent = "Error";
            });
        }
    </script>
</body>
</html>
